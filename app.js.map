{"mappings":"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","sources":["public/js/index.js","public/js/login.js","public/js/alert.js","public/js/mapBox.js","public/js/updateSettings.js"],"sourcesContent":["import { loginFn, logOut } from './login';\r\nimport { displayLocations } from './mapBox';\r\nimport { updateSettings } from './updateSettings';\r\n\r\n// DOM ELEMENTS\r\nconst mapBox = document.getElementById('map');\r\nconst logOutBtn = document.querySelector('.nav__el--logout');\r\nconst loginForm = document.querySelector('.form-login');\r\nconst userUpdateData = document.querySelector('.form-user-data');\r\nconst userUpdatePass = document.querySelector('.form-user-settings');\r\n\r\n// DELEGETION\r\nif (mapBox) {\r\n  const locations = JSON.parse(mapBox.dataset.locations);\r\n  displayLocations(locations);\r\n}\r\n\r\nif (logOutBtn) logOutBtn.addEventListener('click', logOut);\r\n\r\nif (loginForm) {\r\n  loginForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n\r\n    loginFn(email, password);\r\n  });\r\n}\r\n\r\nif (userUpdateData) {\r\n  userUpdateData.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const name = document.getElementById('name').value;\r\n    const email = document.getElementById('email').value;\r\n\r\n    updateSettings({ name, email }, 'data');\r\n  });\r\n}\r\n\r\nif (userUpdatePass) {\r\n  userUpdatePass.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n\r\n    document.querySelector('.save--new--password').textContent = 'Updating...';\r\n\r\n    const password = document.getElementById('password-current').value;\r\n    const newpassword = document.getElementById('password').value;\r\n    const newconfirmPassword =\r\n      document.getElementById('password-confirm').value;\r\n\r\n    // we can not use \"value\" to change the content of HTML element, for that we use innerHTML or textContent\r\n    // we said await only for it to finish, so we can do other stuff\r\n    await updateSettings(\r\n      { password, newpassword, newconfirmPassword },\r\n      'password'\r\n    );\r\n    document.querySelector('.save--new--password').textContent =\r\n      'Save password';\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n  });\r\n}\r\n","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\n\r\nexport const loginFn = async (email, password) => {\r\n  try {\r\n    console.log(`Logging in with email: ${email}, password: ${password}`);\r\n    const res = await axios({\r\n      // here we send our request\r\n      method: 'POST',\r\n      url: 'http://127.0.0.1:3000/api/v3/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n      headers: {\r\n        'Content-Security-Policy':\r\n          \"connect-src 'self' https://cdnjs.cloudflare.com\",\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfuly!');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logOut = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: 'http://127.0.0.1:3000/api/v3/users/logout',\r\n    });\r\n\r\n    if (res.data.status === 'success') location.assign('/');\r\n  } catch (err) {\r\n    showAlert('error', 'Logging out faild, please try again!');\r\n  }\r\n};\r\n","export const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\n// type >>> success of error\r\nexport const showAlert = (type, msg) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n","export const displayLocations = (locations) => {\r\n  var map = L.map('map', { zoomControl: false }); //to disable + - zoom\r\n  // var map = L.map('map', { zoomControl: false }).setView([31.111745, -118.113491], );\r\n\r\n  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    attribution:\r\n      '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n    crossOrigin: '',\r\n  }).addTo(map);\r\n\r\n  const points = [];\r\n  locations.forEach((loc) => {\r\n    points.push([loc.coordinates[1], loc.coordinates[0]]);\r\n    L.marker([loc.coordinates[1], loc.coordinates[0]])\r\n      .addTo(map)\r\n      .bindPopup(`<p>Day ${loc.day}: ${loc.description}</p>`, {\r\n        autoClose: false,\r\n      })\r\n      .openPopup();\r\n  });\r\n\r\n  const bounds = L.latLngBounds(points).pad(0.5);\r\n  map.fitBounds(bounds);\r\n\r\n  map.scrollWheelZoom.disable(); //to disable zoom by mouse wheel\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alert';\r\n\r\nexport const updateSettings = async (data, type) => {\r\n  try {\r\n    const url =\r\n      type === 'data'\r\n        ? 'http://127.0.0.1:3000/api/v3/users/updateMe'\r\n        : 'http://127.0.0.1:3000/api/v3/users/updatemypassword';\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url,\r\n      data,\r\n    });\r\n\r\n    const msg =\r\n      type === 'data'\r\n        ? 'DATA updatd successfuly'\r\n        : 'PASSWORD updatd successfuly';\r\n\r\n    if (res.data.status === 'success') showAlert('success', msg);\r\n\r\n    // if (res.data.status === 'success') {\r\n    //   showAlert('success', 'Personal information updatd successfuly');\r\n    //   window.setTimeout(() => {\r\n    //     location.reload(true);\r\n    //   }, 1500);\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n"],"names":[],"version":3,"file":"app.js.map"}